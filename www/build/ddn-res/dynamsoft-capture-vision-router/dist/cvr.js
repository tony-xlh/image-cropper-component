/*!
 * Dynamsoft JavaScript Library
 * @product Dynamsoft Capture Vision Router JS Edition
 * @website http://www.dynamsoft.com
 * @copyright Copyright 2023, Dynamsoft Corporation
 * @author Dynamsoft
 * @version "2.0.20-dev-20231215173430"
 * @fileoverview Dynamsoft JavaScript Library for Capture Vision
 * More info on cvr JS: https://www.dynamsoft.com/capture-vision-router/sdk-javascript/
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@dynamsoft/dynamsoft-core")):"function"==typeof define&&define.amd?define(["exports","@dynamsoft/dynamsoft-core"],t):t(((e="undefined"!=typeof globalThis?globalThis:e||self).Dynamsoft=e.Dynamsoft||{},e.Dynamsoft.CVR={}),e.Dynamsoft.Core)}(this,(function(e,t){"use strict";const s=e=>e&&"object"==typeof e&&"function"==typeof e.then;class i extends Promise{constructor(e){let t,i;super(((e,s)=>{t=e,i=s})),this._s="pending",this.resolve=e=>{this.isPending&&(s(e)?this.task=e:(this._s="fulfilled",t(e)))},this.reject=e=>{this.isPending&&(this._s="rejected",i(e))},this.task=e}get status(){return this._s}get isPending(){return"pending"===this._s}get isFulfilled(){return"fulfilled"===this._s}get isRejected(){return"rejected"===this._s}get task(){return this._task}set task(e){let t;this._task=e,s(e)?t=e:"function"==typeof e&&(t=new Promise(e)),t&&(async()=>{try{const s=await t;e===this._task&&this.resolve(s)}catch(t){e===this._task&&this.reject(t)}})()}get isEmpty(){return null==this._task}}class a{constructor(){this.intermediateResultReceiverSet=new Set}addResultReceiver(e){if("object"!=typeof e)throw new Error("Invalid receiver.");this.intermediateResultReceiverSet.add(e)}removeResultReceiver(e){this.intermediateResultReceiverSet.delete(e)}}var r={onTaskResultsReceived:!1,onTaskResultsReceivedForDce:!1,onPredetectedRegionsReceived:!1,onLocalizedBarcodesReceived:!1,onDecodedBarcodesReceived:!1,onLocalizedTextLinesReceived:!1,onRecognizedTextLinesReceived:!1,onDetectedQuadsReceived:!1,onNormalizedImagesReceived:!1,onColourImageUnitReceived:!1,onScaledDownColourImageUnitReceived:!1,onGrayscaleImageUnitReceived:!1,onTransformedGrayscaleImageUnitReceived:!1,onEnhancedGrayscaleImageUnitReceived:!1,onBinaryImageUnitReceived:!1,onTextureDetectionResultUnitReceived:!1,onTextureRemovedGrayscaleImageUnitReceived:!1,onTextureRemovedBinaryImageUnitReceived:!1,onContoursUnitReceived:!1,onLineSegmentsUnitReceived:!1,onTextZonesUnitReceived:!1,onTextRemovedBinaryImageUnitReceived:!1,onLongLinesUnitReceived:!1,onCornersUnitReceived:!1,onCandidateQuadEdgesUnitReceived:!1,onCandidateBarcodeZonesUnitReceived:!1,onScaledUpBarcodeImageUnitReceived:!1,onDeformationResistedBarcodeImageUnitReceived:!1,onComplementedBarcodeImageUnitReceived:!1};const n="undefined"==typeof self,o=(()=>{if(!n&&document.currentScript){let e=document.currentScript.src,t=e.indexOf("?");if(-1!=t)e=e.substring(0,t);else{let t=e.indexOf("#");-1!=t&&(e=e.substring(0,t))}return e.substring(0,e.lastIndexOf("/")+1)}return"./"})();var c,l;t.engineResourcePaths.cvr=o,t.workerAutoResources.cvr={js:!0,wasm:!0},t.mapPackageRegister.cvr={};class d{static getVersion(){return this._version}}function u(e,t){if(!e)return[];"string"==typeof e&&(e=JSON.parse(e));let s=[],i=[];function a(t){let s=e.TargetROIDefOptions.filter((e=>t.includes(e.Name)));return s.forEach((e=>{i=i.concat(e.TaskSettingNameArray)})),s}function r(t,a){if(e[t])for(let r=0;r<e[t].length;r++)if(i.includes(e[t][r].Name)){s.push(a);break}}let n=e.CaptureVisionTemplates.findIndex((e=>e.Name===t));n=n<0?0:n;let o=e.CaptureVisionTemplates[n].ImageROIProcessingNameArray||[],c=e.CaptureVisionTemplates[n].SemanticProcessingNameArray,l=a(o).map((e=>{if(e.Location&&e.Location.ReferenceObjectFilter&&e.Location.ReferenceObjectFilter.ReferenceTargetROIDefNameArray)return e.Location.ReferenceObjectFilter.ReferenceTargetROIDefNameArray})).filter(Boolean),d=[];return l.forEach((e=>{d=d.concat(e)})),d=[...new Set(d)],a(d),i=[...new Set(i)],c&&c.length&&s.push("dcp"),r("BarcodeReaderTaskSettingOptions","dbr"),r("LabelRecognizerTaskSettingOptions","dlr"),r("DocumentNormalizerTaskSettingOptions","ddn"),s}async function m(e,t){return await new Promise(((s,i)=>{let a=new XMLHttpRequest;a.open("GET",e,!0),a.responseType=t,a.send(),a.onloadend=async()=>{s(a.response)},a.onerror=()=>{i(new Error("Network Error: "+a.statusText))}}))}d._version=`2.0.20-dev-20231215173430(Worker: ${null===(c=t.innerVersions.cvr)||void 0===c?void 0:c.worker}, Wasm: loading...`,e.EnumImageSourceState=void 0,(l=e.EnumImageSourceState||(e.EnumImageSourceState={}))[l.ISS_BUFFER_EMPTY=0]="ISS_BUFFER_EMPTY",l[l.ISS_EXHAUSTED=1]="ISS_EXHAUSTED";const h=t.EnumCapturedResultItemType;function g(e){const t={barcodesResultItems:[],textLinesResultItems:[],quadsResultItems:[],normalizedImageResultItems:[],parsedResultItems:[]};return e.items.forEach((e=>{e.type===h.CRIT_BARCODE?t.barcodesResultItems.push(e):e.type===h.CRIT_TEXT_LINE?t.textLinesResultItems.push(e):e.type===h.CRIT_DETECTED_QUAD?t.quadsResultItems.push(e):e.type===h.CRIT_NORMALIZED_IMAGE?t.normalizedImageResultItems.push(e):e.type===h.CRIT_PARSED_RESULT&&t.parsedResultItems.push(e)})),t}function p(e){let s,i=e.bytes;if(!(i&&i instanceof Uint8Array))throw Error("Parameter type error");if(Number(e.format)===t.EnumImagePixelFormat.IPF_BGR_888){const e=i.length/3;s=new Uint8ClampedArray(4*e);for(let t=0;t<e;++t)s[4*t]=i[3*t],s[4*t+1]=i[3*t+1],s[4*t+2]=i[3*t+2],s[4*t+3]=255}else if(Number(e.format)===t.EnumImagePixelFormat.IPF_RGB_888){const e=i.length/3;s=new Uint8ClampedArray(4*e);for(let t=0;t<e;++t)s[4*t]=i[3*t+2],s[4*t+1]=i[3*t+1],s[4*t+2]=i[3*t],s[4*t+3]=255}else if(Number(e.format)===t.EnumImagePixelFormat.IPF_GRAYSCALED){const e=i.length;s=new Uint8ClampedArray(4*e);for(let t=0;t<e;t++)s[4*t]=s[4*t+1]=s[4*t+2]=i[t],s[4*t+3]=255}else if(Number(e.format)===t.EnumImagePixelFormat.IPF_BINARY_8){const t=i.length,a=e.width,r=e.height,n=e.stride;s=new Uint8ClampedArray(a*r*4);for(let e=0;e<t;e++){let t=i[e],r=e%n,o=Math.floor(e/n);for(let e=0;e<8;e++){let i=r+e,n=4*(o*a+i);if(i>=a)break;s[n]=s[n+1]=s[n+2]=(128&t)/128*255,s[n+3]=255,t<<=1}}}else if(Number(e.format)===t.EnumImagePixelFormat.IPF_ABGR_8888){const e=i.length/4;s=new Uint8ClampedArray(i.length);for(let t=0;t<e;++t)s[4*t]=i[4*t],s[4*t+1]=i[4*t+1],s[4*t+2]=i[4*t+2],s[4*t+3]=i[4*t+3]}else if(Number(e.format)===t.EnumImagePixelFormat.IPF_ARGB_8888){const e=i.length/4;s=new Uint8ClampedArray(i.length);for(let t=0;t<e;++t)s[4*t]=i[4*t],s[4*t+1]=i[4*t+1],s[4*t+2]=i[4*t+2],s[4*t+3]=i[4*t+3]}return new ImageData(s,e.width,e.height)}function R(e,t){e.toCanvas=()=>_(t),e.toImage=e=>function(e,t){const s=_(t);let i=new Image,a=s.toDataURL(e);return i.src=a,i}(e,t),e.toBlob=e=>I(e,t),e.saveToFile=async(e,s)=>{if(!e)return null;if("string"!=typeof e)throw new TypeError("FileName must be of type string.");return async function(e,t,s){return await new Promise((async(i,a)=>{try{const a=t.split(".");let r=a[a.length-1];const n=await I(`image/${r}`,e);a.length<=1&&(r="png");const o=new File([n],t,{type:`image/${r}`});if(s){const e=URL.createObjectURL(o),s=document.createElement("a");s.href=e,s.download=t,s.click()}return i(o)}catch(e){return a()}}))}(t,e,s)}}function _(e){const t=document.createElement("canvas");t.width=e.width,t.height=e.height;return t.getContext("2d",{willReadFrequently:!0}).putImageData(e,0,0),t}async function I(e,t){const s=_(t);return new Promise(((t,i)=>{s.toBlob((e=>t(e)),e)}))}const f="function"==typeof BigInt;class v{constructor(){this._maxCvsSideLength=["iPhone","Android","HarmonyOS"].includes(t.CoreModule.browserInfo.OS)?2048:4096,this._isa=null,this._dsImage=null,this._instanceID=void 0,this._bPauseScan=!0,this._bNeedOutputOriginalImage=!1,this._canvas=null,this._irrRegistryState=r,this._resultReceiverSet=new Set,this._isaStateListenerSet=new Set,this._resultFilterSet=new Set,this._intermediateResultReceiverSet=new Set,this._intermediateResultManager=null,this._templateName="Default",this._bOpenDetectVerify=!1,this._bOpenNormalizeVerify=!1,this._bOpenBarcodeVerify=!1,this._bOpenLabelVerify=!1,this._minImageCaptureInterval=0,this._averageProcessintTimeArray=[],this._averageFetchImageTimeArray=[],this._currentSettings=null,this._averageTime=999,this.captureInParallel=!0,this.bDestroyed=!1,this._promiseStartScan=null}get maxCvsSideLength(){return this._maxCvsSideLength}set maxCvsSideLength(e){this._maxCvsSideLength=e}get isa(){return this._isa}set isa(e){this._isa=e}get disposed(){return this.bDestroyed}_checkIsDisposed(){if(this.disposed)throw new Error('"CaptureVisionRouter" instance has been disposed')}static async createInstance(){if(!t.mapPackageRegister.license)throw Error("Module `license` is not existed.");await t.mapPackageRegister.license.initLicense(),await t.loadWasm(["DIP","CVR"]);const e=new v,s=new i;let a=t.getNextTaskID();return t.mapTaskCallBack[a]=async i=>{var a;if(i.success)e._instanceID=i.instanceID,e._currentSettings=await e.outputSettings("*"),d._version=`2.0.20-dev-20231215173430(Worker: ${null===(a=t.innerVersions.cvr)||void 0===a?void 0:a.worker}, Wasm: ${i.version})`,0===t.CoreModule.bSupportDce4Module&&(e._intermediateResultManager=e.getIntermediateResultManager(!0)),s.resolve(e);else{const e=Error(i.message);i.stack&&(e.stack=i.stack),s.reject(e)}},t.worker.postMessage({type:"cvr_createInstance",id:a}),s}setInput(e){if(this._checkIsDisposed(),e){if(this.isa=e,e.isCameraEnhancer){this.isa.setPixelFormat(t.EnumImagePixelFormat.IPF_GRAYSCALED),this._intermediateResultManager&&(this.isa._intermediateResultReceiver.isDce=!0,this._intermediateResultManager.addResultReceiver(this.isa._intermediateResultReceiver));const s=this.isa.getCameraView();if(s){const e=s._capturedResultReceiver;e.isDce=!0,this._resultReceiverSet.add(e)}e.on("singleFrameAcquired",(async e=>{for(let t of this._resultReceiverSet)this._bNeedOutputOriginalImage&&t.onOriginalImageResultReceived&&t.onOriginalImageResultReceived({imageData:e});const t={bytes:new Uint8Array(e.bytes),width:e.width,height:e.height,stride:e.stride,format:e.format,tag:e.tag},s=await this.capture(t,this._templateName);s.originalImageTag=e.tag;for(let e of this._resultReceiverSet)e.isDce&&e.onCapturedResultReceived(s,{isDetectVerifyOpen:!1,isNormalizeVerifyOpen:!1,isBarcodeVerifyOpen:!1,isLabelVerifyOpen:!1});const i=g(s);for(let e of this._resultReceiverSet)e.onDecodedBarcodesReceived&&i.barcodesResultItems.length&&e.onDecodedBarcodesReceived({originalImageHashId:s.originalImageHashId,originalImageTag:s.originalImageTag,barcodesResultItems:i.barcodesResultItems.filter((e=>!e.isFilter))}),e.onRecognizedTextLinesReceived&&i.textLinesResultItems.length&&e.onRecognizedTextLinesReceived({textLinesResultItems:i.textLinesResultItems}),e.onDetectedQuadsReceived&&i.quadsResultItems.length&&e.onDetectedQuadsReceived({originalImageHashId:s.originalImageHashId,originalImageTag:s.originalImageTag,quadsResultItems:i.quadsResultItems}),e.onNormalizedImagesReceived&&i.normalizedImageResultItems.length&&e.onNormalizedImagesReceived({originalImageHashId:s.originalImageHashId,originalImageTag:s.originalImageTag,normalizedImageResultItems:i.normalizedImageResultItems}),e.onParsedResultsReceived&&i.parsedResultItems.length&&e.onParsedResultsReceived({parsedResultItems:i.parsedResultItems}),e.onCapturedResultReceived&&!e.isDce&&(s.items=s.items.filter((e=>!e.isFilter)),e.onCapturedResultReceived(s))}))}}else this.isa=null}getInput(){return this._isa}addImageSourceStateListener(e){if(this._checkIsDisposed(),"object"!=typeof e)return console.warn("Invalid ISA state listener.");e&&Object.keys(e)&&this._isaStateListenerSet.add(e)}removeImageSourceStateListener(e){return this._checkIsDisposed(),this._isaStateListenerSet.delete(e)}addResultReceiver(e){if(this._checkIsDisposed(),"object"!=typeof e)throw new Error("Invalid receiver.");if(e&&Object.keys(e).length){this._resultReceiverSet.add(e);for(let t in e){let s=e[t];Object.defineProperty(e,t,{configurable:!0,get:()=>s,set:async e=>{s=e,this._setCrrRegistry()}})}this._setCrrRegistry()}}removeResultReceiver(e){this._checkIsDisposed(),this._resultReceiverSet.delete(e),this._setCrrRegistry()}async _setCrrRegistry(){const e={onCapturedResultReceived:!1,onDecodedBarcodesReceived:!1,onRecognizedTextLinesReceived:!1,onDetectedQuadsReceived:!1,onNormalizedImagesReceived:!1};for(let t of this._resultReceiverSet)t.isDce||(t.onCapturedResultReceived&&(e.onCapturedResultReceived=!0),t.onDecodedBarcodesReceived&&(e.onDecodedBarcodesReceived=!0),t.onRecognizedTextLinesReceived&&(e.onRecognizedTextLinesReceived=!0),t.onDetectedQuadsReceived&&(e.onDetectedQuadsReceived=!0),t.onNormalizedImagesReceived&&(e.onNormalizedImagesReceived=!0));const s=new i;let a=t.getNextTaskID();return t.mapTaskCallBack[a]=async e=>{if(e.success)s.resolve();else{let t=new Error(e.message);t.stack=e.stack+"\n"+t.stack,s.reject()}},t.worker.postMessage({type:"cvr_setCrrRegistry",id:a,instanceID:this._instanceID,body:{receiver:JSON.stringify(e)}}),s}async addResultFilter(e){if(this._checkIsDisposed(),"object"!=typeof e)return console.warn("Invalid filter.");if(e&&Object.keys(e)){for(let t in e.verificationEnabled)await this._enableResultCrossVerification(Number(t),await e.verificationEnabled[t]);for(let t in e.duplicateFilterEnabled)await this._enableResultDeduplication(Number(t),await e.duplicateFilterEnabled[t]);for(let t in e.duplicateForgetTime)await this._setDuplicateForgetTime(Number(t),await e.duplicateForgetTime[t]);this._resultFilterSet.add(e),this._handleFilterSwitch();for(let t in e.verificationEnabled){let s=e.verificationEnabled[Number(t)];Object.defineProperty(e.verificationEnabled,t,{configurable:!0,get:()=>s,set:async e=>{s=e,this._handleFilterSwitch(),await this._enableResultCrossVerification(Number(t),e)}})}for(let t in e.duplicateFilterEnabled){let s=e.duplicateFilterEnabled[Number(t)];Object.defineProperty(e.duplicateFilterEnabled,t,{configurable:!0,get:()=>s,set:async e=>{s=e,await this._enableResultDeduplication(Number(t),e)}})}for(let t in e.duplicateForgetTime){let s=e.duplicateForgetTime[Number(t)];Object.defineProperty(e.duplicateForgetTime,t,{configurable:!0,get:()=>s,set:async e=>{e>18e4&&(e=18e4),e<0&&(e=0),s=e,await this._setDuplicateForgetTime(Number(t),e)}})}}}removeResultFilter(e){this._checkIsDisposed(),this._resultFilterSet.delete(e),this._handleFilterSwitch()}_handleFilterSwitch(){this._bOpenBarcodeVerify=!1,this._bOpenLabelVerify=!1,this._bOpenDetectVerify=!1,this._bOpenNormalizeVerify=!1;for(let e of this._resultFilterSet)e.isResultCrossVerificationEnabled(t.EnumCapturedResultItemType.CRIT_BARCODE)&&(this._bOpenBarcodeVerify=!0),e.isResultCrossVerificationEnabled(t.EnumCapturedResultItemType.CRIT_TEXT_LINE)&&(this._bOpenLabelVerify=!0),e.isResultCrossVerificationEnabled(t.EnumCapturedResultItemType.CRIT_DETECTED_QUAD)&&(this._bOpenDetectVerify=!0),e.isResultCrossVerificationEnabled(t.EnumCapturedResultItemType.CRIT_NORMALIZED_IMAGE)&&(this._bOpenNormalizeVerify=!0)}async startCapturing(e="Default"){if(this._checkIsDisposed(),!this._bPauseScan)return;if(!this.isa)throw new Error("'ImageSourceAdapter' is not set. call 'setInput' before 'startCapturing'");if(void 0!==this.isa.singleFrameMode&&"disabled"!==this.isa.singleFrameMode)return void(this._templateName=e);if(v._oldTemplateMap&&v._oldTemplateMap[e]&&(e=v._oldTemplateMap[e]),!this._currentSettings.CaptureVisionTemplates.find((t=>t.Name===e)))throw new Error("Non-existent template name, please confirm whether initSettings is successful.");v._builtInDbrTemplates.includes(e)&&!t.CoreModule.isModuleLoaded("dbr")?await t.loadWasm("dbr"):v._builtInDlrTemplates.includes(e)&&!t.CoreModule.isModuleLoaded("dlr")?await t.loadWasm("dlr"):v._builtInDdnTemplates.includes(e)&&!t.CoreModule.isModuleLoaded("ddn")&&await t.loadWasm("ddn");return this.isa.getColourChannelUsageType()===t.EnumColourChannelUsageType.CCUT_AUTO&&(u(this._currentSettings).includes("ddn")?this.isa.setColourChannelUsageType(t.EnumColourChannelUsageType.CCUT_FULL_CHANNEL):this.isa.setColourChannelUsageType(t.EnumColourChannelUsageType.CCUT_Y_CHANNEL_ONLY)),this._promiseStartScan&&this._promiseStartScan.isPending?this._promiseStartScan:(this._promiseStartScan=new i(((s,i)=>{if(this.disposed)return;let a=t.getNextTaskID();t.mapTaskCallBack[a]=async t=>{if(this._promiseStartScan&&!this._promiseStartScan.isFulfilled){if(!t.success){let e=new Error(t.message);return e.stack=t.stack+"\n"+e.stack,i(e)}["ReadBarcodes_ReadRateFirst","ReadBarcodes_Balance","ReadDenseBarcodes"].includes(e.toLowerCase())&&(this.maxCvsSideLength=4096);for(let e of this._resultFilterSet)await this.addResultFilter(e);this._bNeedOutputOriginalImage=t.bNeedOutputOriginalImage,this._bPauseScan=!1,this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),this._loopReadVideoTimeoutId=setTimeout((async()=>{-1!==this._minImageCaptureInterval&&this.isa.startFetching(),this._loopReadVideo(e),s()}),0)}},this.isa.isCameraEnhancer&&this.isa.getCameraView().setScanLaserVisible(!0),t.worker.postMessage({type:"cvr_startCapturing",id:a,instanceID:this._instanceID,body:{templateName:e}})})),await this._promiseStartScan)}stopCapturing(){this._checkIsDisposed(),this.isa&&(this.isa.stopFetching(),this._clearVerifyList(),this._averageProcessintTimeArray=[],this._averageTime=999,this.isa.isCameraEnhancer&&this.isa.getCameraView().setScanLaserVisible(!1),this._bPauseScan=!0,this._promiseStartScan=null,this.isa.setColourChannelUsageType(t.EnumColourChannelUsageType.CCUT_AUTO),this.maxCvsSideLength=["iPhone","Android","HarmonyOS"].includes(t.CoreModule.browserInfo.OS)?2048:4096)}async _clearVerifyList(){let e=t.getNextTaskID();const s=new i;return t.mapTaskCallBack[e]=async e=>{if(e.success)return s.resolve();{let t=new Error(e.message);return t.stack=e.stack+"\n"+t.stack,s.reject(t)}},t.worker.postMessage({type:"cvr_clearVerifyList",id:e,instanceID:this._instanceID}),s}async _getIntermediateResult(){this._checkIsDisposed();let e=t.getNextTaskID();const s=new i;return t.mapTaskCallBack[e]=async e=>{if(e.success)s.resolve(e.result);else{let t=new Error(e.message);t.stack=e.stack+"\n"+t.stack,s.reject(t)}},t.worker.postMessage({type:"cvr_getIntermediateResult",id:e,instanceID:this._instanceID}),s}async _loopReadVideo(t){if(this.disposed||this._bPauseScan)return;if(this.isa.isBufferEmpty())if(this.isa.hasNextImageToFetch())for(let t of this._isaStateListenerSet)t.onImageSourceStateListener&&t.onImageSourceStateListener(e.EnumImageSourceState.ISS_BUFFER_EMPTY);else if(!this.isa.hasNextImageToFetch())for(let t of this._isaStateListenerSet)t.onImageSourceStateListener&&t.onImageSourceStateListener(e.EnumImageSourceState.ISS_EXHAUSTED);if(-1===this._minImageCaptureInterval||this.isa.isBufferEmpty())try{v._onLog&&v._onLog(`DCE: start fetching a frame: ${Date.now()}`),this._dsImage=this.isa.fetchImage(),v._onLog&&v._onLog(`DCE: finish fetching a frame: ${Date.now()}`),this.isa.setImageFetchInterval(this._averageTime)}catch(e){return void this._reRunCurrnetFunc(t)}else if(this.isa.setImageFetchInterval(this._averageTime-(this._dsImage&&this._dsImage.tag?this._dsImage.tag.timeSpent:0)),this._dsImage=this.isa.getImage(),this._dsImage.tag&&Date.now()-this._dsImage.tag.timeStamp>200)return void this._reRunCurrnetFunc(t);if(!this._dsImage)return void this._reRunCurrnetFunc(t);for(let e of this._resultReceiverSet)this._bNeedOutputOriginalImage&&e.onOriginalImageResultReceived&&e.onOriginalImageResultReceived({imageData:this._dsImage});const s=Date.now();let i=null;this._captureDsimage(this._dsImage,t,!0).then((async e=>{if(i=e,this._bPauseScan)return void this._reRunCurrnetFunc(t);const a=i.intermediateResult;if(a){if(a.taskSet)for(let e of a.taskSet.intermediateResultUnits)e.originalImageTag=this._dsImage.tag?this._dsImage.tag:null;for(let e of this._intermediateResultReceiverSet){if(a.taskSet&&e.onTaskResultsReceived&&e.onTaskResultsReceived({intermediateResultUnits:a.taskSet.intermediateResultUnits},a.taskSet.info),a.sectionSet)for(let t in a.sectionSet){for(let s of a.sectionSet[t].asStage)e[t]&&e[t](s.result,s.info);for(let s of a.sectionSet[t].asSection)e[t]&&e[t](s.result,s.info)}if(a.stageSet)for(let t in a.stageSet)for(let s of a.stageSet[t])e[t]&&e[t](s.result,s.info)}}i.originalImageTag=this._dsImage.tag?this._dsImage.tag:null;for(let e of this._resultReceiverSet)e.isDce&&e.onCapturedResultReceived(i,{isDetectVerifyOpen:this._bOpenDetectVerify,isNormalizeVerifyOpen:this._bOpenNormalizeVerify,isBarcodeVerifyOpen:this._bOpenBarcodeVerify,isLabelVerifyOpen:this._bOpenLabelVerify});for(let e of this._resultFilterSet)e.onDecodedBarcodesReceived(i.items),e.onRecognizedTextLinesReceived(i.items),e.onDetectedQuadsReceived(i.items),e.onNormalizedImagesReceived(i.items);const r=g(i),n={originalImageHashId:i.originalImageHashId,originalImageTag:i.originalImageTag,errorCode:i.errorCode,errorString:i.errorString};for(let e of this._resultReceiverSet)e.onDecodedBarcodesReceived&&r.barcodesResultItems.length&&e.onDecodedBarcodesReceived(Object.assign(Object.assign({},n),{barcodesResultItems:r.barcodesResultItems.filter((e=>!e.isFilter))})),e.onRecognizedTextLinesReceived&&r.textLinesResultItems.length&&e.onRecognizedTextLinesReceived(Object.assign(Object.assign({},n),{textLinesResultItems:r.textLinesResultItems.filter((e=>!e.isFilter))})),e.onDetectedQuadsReceived&&r.quadsResultItems.length&&e.onDetectedQuadsReceived(Object.assign(Object.assign({},n),{quadsResultItems:r.quadsResultItems.filter((e=>!e.isFilter))})),e.onNormalizedImagesReceived&&r.normalizedImageResultItems.length&&e.onNormalizedImagesReceived(Object.assign(Object.assign({},n),{normalizedImageResultItems:r.normalizedImageResultItems.filter((e=>!e.isFilter))})),e.onParsedResultsReceived&&r.parsedResultItems.length&&e.onParsedResultsReceived(Object.assign(Object.assign({},n),{parsedResultItems:r.parsedResultItems})),e.onCapturedResultReceived&&!e.isDce&&(i.items=i.items.filter((e=>!e.isFilter)),e.onCapturedResultReceived(i));const o=Date.now()-s;this._minImageCaptureInterval>-1&&(5===this._averageProcessintTimeArray.length&&this._averageProcessintTimeArray.shift(),5===this._averageFetchImageTimeArray.length&&this._averageFetchImageTimeArray.shift(),this._averageProcessintTimeArray.push(o),this._averageFetchImageTimeArray.push(this._dsImage&&this._dsImage.tag?this._dsImage.tag.timeSpent:0),this._averageTime=Math.min(...this._averageProcessintTimeArray)-Math.max(...this._averageFetchImageTimeArray),this._averageTime=this._averageTime>0?this._averageTime:0,v._onLog&&(v._onLog(`minImageCaptureInterval: ${this._minImageCaptureInterval}`),v._onLog(`averageProcessintTimeArray: ${this._averageProcessintTimeArray}`),v._onLog(`averageFetchImageTimeArray: ${this._averageFetchImageTimeArray}`),v._onLog(`averageTime: ${this._averageTime}`))),v._onLog&&v._onLog(`time finish decode: ${Date.now()}`),v._onLog&&v._onLog("===================================================="),this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),this._minImageCaptureInterval>0&&this._minImageCaptureInterval>=this._averageTime?this._loopReadVideoTimeoutId=setTimeout((()=>{this._loopReadVideo(t)}),this._minImageCaptureInterval-this._averageTime):this._loopReadVideoTimeoutId=setTimeout((()=>{this._loopReadVideo(t)}),Math.max(this._minImageCaptureInterval,0))})).catch((e=>{this.isa.stopFetching(),this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),this._loopReadVideoTimeoutId=setTimeout((()=>{this.isa.startFetching(),this._loopReadVideo(t)}),Math.max(this._minImageCaptureInterval,1e3)),"platform error"!==e.message&&console.warn(e.message)})).finally((()=>{i&&i.intermediateResult&&delete i.intermediateResult}))}_reRunCurrnetFunc(e){this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),this._loopReadVideoTimeoutId=setTimeout((()=>{this._loopReadVideo(e)}),0)}async capture(e,s="Default",i=!1){if(this._checkIsDisposed(),!e)return null;if(v._oldTemplateMap&&v._oldTemplateMap[s]&&(s=v._oldTemplateMap[s]),["ReadBarcodes_ReadRateFirst","ReadBarcodes_Balance","ReadDenseBarcodes"].includes(s.toLowerCase())&&(this.maxCvsSideLength=4096),!this._currentSettings.CaptureVisionTemplates.find((e=>e.Name===s)))throw new Error("Non-existent template name, please confirm whether initSettings is successful.");let a;if(v._builtInDbrTemplates.includes(s)&&!t.CoreModule.isModuleLoaded("dbr")?await t.loadWasm("dbr"):v._builtInDlrTemplates.includes(s)&&!t.CoreModule.isModuleLoaded("dlr")?await t.loadWasm("dlr"):v._builtInDdnTemplates.includes(s)&&!t.CoreModule.isModuleLoaded("ddn")&&await t.loadWasm("ddn"),(r=e)&&"object"==typeof r&&!Array.isArray(r)&&"bytes"in r&&"width"in r&&"height"in r&&"stride"in r&&"format"in r)a=await this._captureDsimage(e,s,i);else if("string"==typeof e)a="data:image/"==e.substring(0,11)?await this._captureBase64(e,s,i):await this._captureUrl(e,s,i);else if(e instanceof Blob)a=await this._captureBlob(e,s,i);else if(e instanceof HTMLImageElement)a=await this._captureImage(e,s,i);else if(e instanceof HTMLCanvasElement)a=await this._captureCanvas(e,s,i);else if(e instanceof HTMLVideoElement)a=await this._captureVideo(e,s,i);else{if(!(e instanceof Uint8Array||e instanceof ArrayBuffer||e instanceof Uint8ClampedArray))throw new TypeError("'capture(imageOrFile, templateName)': Type of 'imageOrFile' should be 'DSImageData', 'Url', 'Base64', 'Blob', 'Uint8Array', 'ArrayBuffer', 'Uint8ClampedArray', 'HTMLImageElement', 'HTMLCanvasElement', 'HTMLVideoElement'.");a=await this._captureBlob(new Blob([new Uint8Array(e)],{type:"image/png"}),s,i)}var r;const n=await this._getIntermediateResult();if(n)for(let e of this._intermediateResultReceiverSet){if(n.taskSet&&e.onTaskResultsReceived&&e.onTaskResultsReceived({intermediateResultUnits:n.taskSet.intermediateResultUnits},n.taskSet.info),n.sectionSet)for(let t in n.sectionSet){for(let s of n.sectionSet[t].asStage)e[t]&&e[t](s.result,s.info);for(let s of n.sectionSet[t].asSection)e[t]&&e[t](s.result,s.info)}if(n.stageSet)for(let t in n.stageSet)for(let s of n.stageSet[t])e[t]&&e[t](s.result,s.info)}return a}async _captureDsimage(e,t,s=!1){return await this._captureInWorker(e,t,s)}async _captureUrl(e,t,s=!1){let i=await m(e,"blob");return await this._captureBlob(i,t,s)}async _captureBase64(e,t,s=!1){e=e.substring(e.indexOf(",")+1);let i=atob(e),a=i.length,r=new Uint8Array(a);for(;a--;)r[a]=i.charCodeAt(a);return await this._captureBlob(new Blob([r]),t,s)}async _captureBlob(e,t,s=!1){let i=null,a=null;if("undefined"!=typeof createImageBitmap)try{i=await createImageBitmap(e)}catch(e){}i||(a=await async function(e){return await new Promise(((t,s)=>{let i=URL.createObjectURL(e),a=new Image;a.src=i,a.onload=()=>{URL.revokeObjectURL(a.dbrObjUrl),t(a)},a.onerror=e=>{s(new Error("Can't convert blob to image : "+(e instanceof Event?e.type:e)))}}))}(e));let r=await this._captureImage(i||a,t,s);return i&&i.close(),r}async _captureImage(e,t,s=!1){let i,a,r=e instanceof HTMLImageElement?e.naturalWidth:e.width,n=e instanceof HTMLImageElement?e.naturalHeight:e.height,o=Math.max(r,n);if(o>this.maxCvsSideLength){let e=this.maxCvsSideLength/o;i=Math.round(r*e),a=Math.round(n*e)}else i=r,a=n;this._canvas||(this._canvas=document.createElement("canvas"));const c=this._canvas;c.width===i&&c.height===a||(c.width=i,c.height=a),c.ctx2d||(c.ctx2d=c.getContext("2d",{willReadFrequently:!0}));return c.ctx2d.drawImage(e,0,0,r,n,0,0,i,a),e.dbrObjUrl&&URL.revokeObjectURL(e.dbrObjUrl),await this._captureCanvas(c,t,s)}async _captureCanvas(e,t,s=!1){if(e.crossOrigin&&"anonymous"!=e.crossOrigin)throw"cors";if([e.width,e.height].includes(0))throw Error("The width or height of the 'canvas' is 0.");const i=e.ctx2d||e.getContext("2d",{willReadFrequently:!0}),a={bytes:Uint8Array.from(i.getImageData(0,0,e.width,e.height).data),width:e.width,height:e.height,stride:4*e.width,format:10};return await this._captureInWorker(a,t,s)}async _captureVideo(e,t,s=!1){if(e.crossOrigin&&"anonymous"!=e.crossOrigin)throw"cors";let i,a,r=e.videoWidth,n=e.videoHeight,o=Math.max(r,n);if(o>this._maxCvsSideLength){let e=this._maxCvsSideLength/o;i=Math.round(r*e),a=Math.round(n*e)}else i=r,a=n;this._canvas||(this._canvas=document.createElement("canvas"));const c=this._canvas;c.width===i&&c.height===a||(c.width=i,c.height=a),c.ctx2d||(c.ctx2d=c.getContext("2d",{willReadFrequently:!0}));return c.ctx2d.drawImage(e,0,0,r,n,0,0,i,a),await this._captureCanvas(c,t,s)}async _captureInWorker(e,s,a=!1){const{bytes:r,width:n,height:o,stride:c,format:l}=e;a||(this.maxCvsSideLength=["iPhone","Android","HarmonyOS"].includes(t.CoreModule.browserInfo.OS)?2048:4096);let d=t.getNextTaskID();const u=new i;return t.mapTaskCallBack[d]=async e=>{if(!e.success){let t=new Error(e.message);return t.stack=e.stack+"\n"+t.stack,u.reject(t)}v._onLog&&v._onLog(`get result time from worker: ${Date.now()}`);try{const s=e.captureResult;this._dsImage&&(this._dsImage.bytes=e.bytes);for(let e=0;e<s.items.length;e++)if(s.items[e].type===t.EnumCapturedResultItemType.CRIT_NORMALIZED_IMAGE){const t=p(s.items[e].imageData);R(s.items[e],t)}else s.items[e].type===t.EnumCapturedResultItemType.CRIT_ORIGINAL_IMAGE?s.items[e].imageData=this._dsImage:s.items[e].type===t.EnumCapturedResultItemType.CRIT_PARSED_RESULT&&t.handleParsedResultItem(s.items[e]);return u.resolve(s)}catch(e){return u.reject(e)}},v._onLog&&v._onLog(`send buffer to worker: ${Date.now()}`),t.worker.postMessage({type:"cvr_capture",id:d,instanceID:this._instanceID,body:{bytes:r,width:n,height:o,stride:c,format:l,templateName:s||"",bScanner:a}},[r.buffer]),u}async initSettings(e){return this._checkIsDisposed(),e&&["string","object"].includes(typeof e)?("string"==typeof e&&(/^(https:\/\/www\.|http:\/\/www\.|https:\/\/|http:\/\/)|^[a-zA-Z0-9]{2,}(\.[a-zA-Z0-9]{2,})(\.[a-zA-Z0-9]{2,})?/.test(e)&&(e=await m(e,"text")),this._currentSettings=JSON.parse(e)),"object"==typeof e&&(this._currentSettings=e,e=JSON.stringify(e)),await t.loadWasm(u(this._currentSettings)),await new Promise(((s,i)=>{let a=t.getNextTaskID();t.mapTaskCallBack[a]=async e=>{if(e.success){const t=JSON.parse(e.response);if(0!==t.exception){let e=new Error(t.description?t.description:"Init Settings Failed.");return e.errorCode=t.exception,i(e)}return v._oldTemplateMap=null,this._bNeedOutputOriginalImage=1===this._currentSettings.CaptureVisionTemplates[0].OutputOriginalImage,s(t)}{let t=new Error(e.message);return t.stack=e.stack+"\n"+t.stack,i(t)}},t.worker.postMessage({type:"cvr_initSettings",id:a,instanceID:this._instanceID,body:{settings:e}})}))):console.error("Invalid template.")}async outputSettings(e){if(this._checkIsDisposed(),v._oldTemplateMap&&v._oldTemplateMap[e]&&(e=v._oldTemplateMap[e]),e&&"*"!==e&&this._currentSettings&&!this._currentSettings.CaptureVisionTemplates.find((t=>t.Name===e)))throw new Error("Non-existent template name.");return await new Promise(((s,i)=>{let a=t.getNextTaskID();t.mapTaskCallBack[a]=async e=>{if(e.success){const t=JSON.parse(e.settings);if(0!==t.errorCode){let e=new Error(t.errorString);return e.errorCode=t.errorCode,i(e)}return delete t.errorCode,delete t.errorString,s(t)}{let t=new Error(e.message);return t.stack=e.stack+"\n"+t.stack,i(t)}},t.worker.postMessage({type:"cvr_outputSettings",id:a,instanceID:this._instanceID,body:{templateName:e||"Default"}})}))}async outputSettingsToFile(e,t,s){const i=await this.outputSettings(e),a=new Blob([JSON.stringify(i,null,2,(function(e,t){return t instanceof Array?JSON.stringify(t):t}),2)],{type:"application/json"});if(s){const e=document.createElement("a");e.href=URL.createObjectURL(a),t.endsWith(".json")&&(t=t.replace(".json","")),e.download=`${t}.json`,e.onclick=()=>{setTimeout((()=>{URL.revokeObjectURL(e.href)}),500)},e.click()}return a}async getSimplifiedSettings(e="Default"){if(this._checkIsDisposed(),v._oldTemplateMap&&v._oldTemplateMap[e]&&(e=v._oldTemplateMap[e]),!this._currentSettings.CaptureVisionTemplates.find((t=>t.Name===e)))throw new Error("Non-existent template name.");return await new Promise(((s,i)=>{let a=t.getNextTaskID();t.mapTaskCallBack[a]=async e=>{if(e.success){const t=JSON.parse(e.settings,((e,t)=>f&&"barcodeFormatIds"===e?BigInt(t):t));if(t.minImageCaptureInterval=this._minImageCaptureInterval,0!==t.code){let e=new Error(t.codeString);return e.errorCode=t.errorCode,i(e)}return delete t.code,delete t.codeString,s(t)}{let t=new Error(e.message);return t.stack=e.stack+"\n"+t.stack,i(t)}},t.worker.postMessage({type:"cvr_getSimplifiedSettings",id:a,instanceID:this._instanceID,body:{templateName:e}})}))}async updateSettings(e,s){if(this._checkIsDisposed(),v._oldTemplateMap&&v._oldTemplateMap[e]&&(e=v._oldTemplateMap[e]),!this._currentSettings.CaptureVisionTemplates.find((t=>t.Name===e)))throw new Error("Non-existent template name.");return await new Promise(((i,a)=>{let r=t.getNextTaskID();t.mapTaskCallBack[r]=async e=>{if(e.success){const t=JSON.parse(e.response);if(s.minImageCaptureInterval&&s.minImageCaptureInterval>=-1&&(this._minImageCaptureInterval=s.minImageCaptureInterval),this._bNeedOutputOriginalImage=e.bNeedOutputOriginalImage,0!==t.exception){let e=new Error(t.description?t.description:"Update Settings Failed.");return e.errorCode=t.exception,a(e)}return this._currentSettings=await this.outputSettings("*"),i(t)}{let t=new Error(e.message);return t.stack=e.stack+"\n"+t.stack,a(t)}},t.worker.postMessage({type:"cvr_updateSettings",id:r,instanceID:this._instanceID,body:{settings:s,templateName:e}})}))}async resetSettings(){return this._checkIsDisposed(),await new Promise(((e,s)=>{let i=t.getNextTaskID();t.mapTaskCallBack[i]=async t=>{if(t.success){const i=JSON.parse(t.response);if(0!==i.exception){let e=new Error(i.description?i.description:"Reset Settings Failed.");return e.errorCode=i.exception,s(e)}return this._currentSettings=await this.outputSettings("*"),e(i)}{let e=new Error(t.message);return e.stack=t.stack+"\n"+e.stack,s(e)}},t.worker.postMessage({type:"cvr_resetSettings",id:i,instanceID:this._instanceID})}))}getIntermediateResultManager(e){if(this._checkIsDisposed(),!e&&0!==t.CoreModule.bSupportIRTModule)throw new Error("The current license does not support the use of intermediate results.");return this._intermediateResultManager||(this._intermediateResultManager=new a,this._intermediateResultManager.addResultReceiver=async e=>{if("object"!=typeof e)throw new Error("Invalid receiver.");this._intermediateResultReceiverSet.add(e),this._handleIntermediateResultReceiver();for(let t in e){let i=e[t];Object.defineProperty(e,t,{configurable:!0,get:()=>i,set:async e=>{i=e,this._handleIntermediateResultReceiver(),await s()}})}const s=async()=>await new Promise(((e,s)=>{let i=t.getNextTaskID();t.mapTaskCallBack[i]=async t=>{if(t.success)return e();{let e=new Error(t.message);return e.stack=t.stack+"\n"+e.stack,s(e)}},t.worker.postMessage({type:"cvr_setIrrRegistry",id:i,instanceID:this._instanceID,body:{receiverObj:this._irrRegistryState}})}));return await s()},this._intermediateResultManager.removeResultReceiver=async e=>(this._intermediateResultReceiverSet.delete(e),this._handleIntermediateResultReceiver(),await new Promise(((e,s)=>{let i=t.getNextTaskID();t.mapTaskCallBack[i]=async t=>{if(t.success)return e();{let e=new Error(t.message);return e.stack=t.stack+"\n"+e.stack,s(e)}},t.worker.postMessage({type:"cvr_setIrrRegistry",id:i,instanceID:this._instanceID,body:{receiverObj:this._irrRegistryState}})}))),this._intermediateResultManager.getOriginalImage=async e=>this._dsImage),this._intermediateResultManager}_handleIntermediateResultReceiver(){for(let e in this._irrRegistryState)this._irrRegistryState[e]=!1;for(let e of this._intermediateResultReceiverSet)if(e.isDce)this._irrRegistryState.onTaskResultsReceivedForDce=!0;else for(let t in e)this._irrRegistryState[t]||(this._irrRegistryState[t]=!!e[t])}async _enableResultCrossVerification(e,s){return this._checkIsDisposed(),await new Promise(((i,a)=>{let r=t.getNextTaskID();t.mapTaskCallBack[r]=async e=>{if(e.success)return i(e.result);{let t=new Error(e.message);return t.stack=e.stack+"\n"+t.stack,a(t)}},t.worker.postMessage({type:"cvr_enableResultCrossVerification",id:r,instanceID:this._instanceID,body:{type:e,enabled:s}})}))}async _enableResultDeduplication(e,s){return this._checkIsDisposed(),await new Promise(((i,a)=>{let r=t.getNextTaskID();t.mapTaskCallBack[r]=async e=>{if(e.success)return i(e.result);{let t=new Error(e.message);return t.stack=e.stack+"\n"+t.stack,a(t)}},t.worker.postMessage({type:"cvr_enableResultDeduplication",id:r,instanceID:this._instanceID,body:{type:e,enabled:s}})}))}async _setDuplicateForgetTime(e,s){return this._checkIsDisposed(),await new Promise(((i,a)=>{let r=t.getNextTaskID();t.mapTaskCallBack[r]=async e=>{if(e.success)return i(e.result);{let t=new Error(e.message);return t.stack=e.stack+"\n"+t.stack,a(t)}},t.worker.postMessage({type:"cvr_setDuplicateForgetTime",id:r,instanceID:this._instanceID,body:{type:e,time:s}})}))}async _getDuplicateForgetTime(e){return this._checkIsDisposed(),await new Promise(((s,i)=>{let a=t.getNextTaskID();t.mapTaskCallBack[a]=async e=>{if(e.success)return s(e.time);{let t=new Error(e.message);return t.stack=e.stack+"\n"+t.stack,i(t)}},t.worker.postMessage({type:"cvr_getDuplicateForgetTime",id:a,instanceID:this._instanceID,body:{type:e}})}))}async _setThresholdValue(e,s,i){return await new Promise(((a,r)=>{let n=t.getNextTaskID();t.mapTaskCallBack[n]=async e=>{if(e.success)return a();{let t=new Error(e.message);return t.stack=e.stack+"\n"+t.stack,r(t)}},t.worker.postMessage({type:"cvr_setThresholdValue",id:n,instanceID:this._instanceID,body:{threshold:e,leftLimit:s,rightLimit:i}})}))}contains(e,t){return function(e,t){let s=t.x,i=t.y,a=e[0].x,r=e[0].y,n=e[1].x,o=e[1].y,c=e[2].x,l=e[2].y,d=e[3].x,u=e[3].y,m=R(s,i,a,r,n,o),h=R(s,i,n,o,c,l),g=R(s,i,c,l,d,u),p=R(s,i,d,u,a,r);function R(e,t,s,i,a,r){return(e-s)*(r-i)-(t-i)*(a-s)}return m>=0&&h>=0&&g>=0&&p>=0||m<=0&&h<=0&&g<=0&&p<=0}(e,t)}async dispose(){this._checkIsDisposed(),this._promiseStartScan&&this.stopCapturing(),this.isa=null,this._resultReceiverSet.clear(),this._isaStateListenerSet.clear(),this._resultFilterSet.clear(),this.bDestroyed=!0;let e=t.getNextTaskID();t.mapTaskCallBack[e]=e=>{if(!e.success){let t=new Error(e.message);throw t.stack=e.stack+"\n"+t.stack,t}},t.worker.postMessage({type:"cvr_dispose",id:e,instanceID:this._instanceID})}}v._oldTemplateMap={default:"Default","read-barcodes":"ReadBarcodes_Default","recognize-textlines":"RecognizeTextLines_Default","detect-document-boundaries":"DetectDocumentBoundaries_Default","detect-and-normalize-document":"DetectAndNormalizeDocument_Default","normalize-document":"NormalizeDocument_Default"},v._builtInDbrTemplates=["ReadBarcodes_Balance","ReadBarcodes_Default","ReadBarcodes_ReadRateFirst","ReadBarcodes_SpeedFirst","ReadDenseBarcodes","ReadDistantBarcodes","ReadSingleBarcode"],v._builtInDlrTemplates=["RecognizeTextLines_Default","RecognizeNumbers","RecognizeLetters","RecognizeUppercaseLetters","RecognizeNumbersAndUppercaseLetters","RecognizeNumbersAndLetters"],v._builtInDdnTemplates=["DetectAndNormalizeDocument_Default","DetectDocumentBoundaries_Default","NormalizeDocument_Default"];e.CaptureVisionRouter=v,e.CaptureVisionRouterModule=d,e.CapturedResultReceiver=class{constructor(){this.onCapturedResultReceived=null,this.onOriginalImageResultReceived=null,this.onDecodedBarcodesReceived=null,this.onRecognizedTextLinesReceived=null,this.onDetectedQuadsReceived=null,this.onNormalizedImagesReceived=null,this.onParsedResultsReceived=null}},e.IntermediateResultManager=a,e.IntermediateResultReceiver=class{constructor(){this.onTaskResultsReceived=null,this.onPredetectedRegionsReceived=null,this.onLocalizedBarcodesReceived=null,this.onDecodedBarcodesReceived=null,this.onLocalizedTextLinesReceived=null,this.onRecognizedTextLinesReceived=null,this.onDetectedQuadsReceived=null,this.onNormalizedImagesReceived=null,this.onColourImageUnitReceived=null,this.onScaledDownColourImageUnitReceived=null,this.onGrayscaleImageUnitReceived=null,this.onTransformedGrayscaleImageUnitReceived=null,this.onEnhancedGrayscaleImageUnitReceived=null,this.onBinaryImageUnitReceived=null,this.onTextureDetectionResultUnitReceived=null,this.onTextureRemovedGrayscaleImageUnitReceived=null,this.onTextureRemovedBinaryImageUnitReceived=null,this.onContoursUnitReceived=null,this.onLineSegmentsUnitReceived=null,this.onTextZonesUnitReceived=null,this.onTextRemovedBinaryImageUnitReceived=null,this.onLongLinesUnitReceived=null,this.onCornersUnitReceived=null,this.onCandidateQuadEdgesUnitReceived=null,this.onCandidateBarcodeZonesUnitReceived=null,this.onScaledUpBarcodeImageUnitReceived=null,this.onDeformationResistedBarcodeImageUnitReceived=null,this.onComplementedBarcodeImageUnitReceived=null}}}));
//# sourceMappingURL=cvr.js.map
